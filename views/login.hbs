
<form id="login" class="container g-3 mt-5" method="POST">
    <div class="col-lg-12 d-flex justify-content-center ">
        <div class="col-4">
            <div class="form-outline mb-3">
                <label class="form-label">Correo</label>
                <input type="text" name="username" id="username" class="form-control" />
            </div>
            <div class="form-outline mb-3">
                <label class="form-label">Contrasena</label>
                <input type="password" name="password" id="password" class="form-control" />
            </div>
            <div class="form-outline mb-3">
                <button class="btn btn-success" type="submit">Login</button>
            </div>
        </div>
    </div>
</form>

<script type="text/javascript">
    const formLogin = document.querySelector("#login");
    formLogin.addEventListener('submit', async event  =>  {
        event.preventDefault(); // no envia submit
        const formData = new FormData(formLogin);

        data = JSON.stringify({  username : document.getElementById('username').value, password: document.getElementById('password').value,})

        const response = await fetch('/api/login', { //api consulta login
            method:"POST",
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            body: data,
        }).then(res => res.json().then(data => ({status: res.status, body: data})));

        let statusCode = response.status;
        let body = response.body;

        if (statusCode == 200){
            localStorage.setItem('jwt', body.token);
            window.location = 'home';
        }else{
            Swal.fire({
                icon: 'error',
                text: 'Correo y/o contrasena incorrecto',
            });
        }
    });
</script>